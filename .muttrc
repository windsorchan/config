# source color scheme
source ~/.mutt/colors.muttrc

# conditionally source sidebar options 
source `FILE=$HOME/.mutt/sidebar.muttrc; mutt -v | grep -Fq sidebar || FILE=/dev/null; echo $FILE`

# directories and commands
set alias_file          = ~/.mutt/alias                         # alias file
set certificate_file    = ~/.mutt/certificates                  # where to store certs
set header_cache        = ~/.mutt/cache/headers                 # where to store headers
set message_cachedir    = ~/.mutt/cache/bodies                  # where to store bodies
set mailcap_path        = ~/.mutt/mailcap                       # entrys for filetypes
set signature           = ~/.mutt/sig                           # my signature file
set tmpdir              = ~/.mutt/temp                          # where to keep temp files
set editor              = "vim +:silent+?^$"                    # use vim and skip to last blank line
set ispell              = "aspell -e -c"                        # use aspell as ispell
#  set query_command       = "abook --mutt-query '%s'"             # query abook for contacts
#  set query_command       = "DM_ROOT=$HOME/.dm $HOME/.dm/bin/contacts.py -m short -r -s name %s" # query google directly
set query_command       = "mail-query '%s' ~/Mail/GMail/INBOX"  # query existing mails
set print_command       = "enscript -p - | psselect -r | lp"    # print email in reverse page order

# options
set mbox_type   = Maildir               # mailbox type
set folder      = ~/mail          # root folder
set spoolfile   = "+GMail/inbox"              # inbox
#set mbox        = "+archive"            # [Gmail]/All Mail
set postponed   = "+GMail/drafts"             # [Gmail]/Drafts
unset record                            # required to prevent duplicates in Sent

set sendmail    = /usr/bin/msmtp        # use msmtp 'default' account

# mailboxes
mailboxes "+GMail/akpsi" "+GMail/campus mail" "+GMail/career mail" "+GMail/confirmations" "+GMail/cs 162" "+GMail/drafts" "+GMail/finances" "+GMail/flagged"     "+GMail/inbox" "+GMail/linkedin newsgroups" "+GMail/math mailing list" "+GMail/retailers" "+GMail/sent" "+GMail/spam" "+GMail/trash"

# bindings
macro index D "<save-message>+trash<enter>"   "move message to the trash"
macro index S "<save-message>+spam<enter>"    "mark message as spam"
macro pager \cb <pipe-entry>'urlview'<enter> 'Follow links with urlview'

# main options
set realname            = "Windsor"                     # who am i?
set from                = "wchan916@gmail.com"          # who am i?
set envelope_from                                       # which from?
unset move                                              # gmail does that
set quit                                                # don't ask, just do!!
set beep_new                                                    # terminal bell on new message
unset confirmappend                                               # don't ask, just do
set delete                                                      # don't ask, just do
set mail_check          = 0                                     # minimum time between scans
unset markers                                                     # no ugly plus signs
unset mark_old                                                    # read/new is good enough for me
set menu_scroll                                                 # scroll in menus
set pager_index_lines   = 10                                    # number of index lines to show
set pager_context       = 5                                     # number of context lines to show
set pager_stop                                                  # don't go to next message automatically
set pipe_decode                                                 # strip headers and eval mimes when piping
set reverse_alias                                               # show names from alias file in index
set sort                = threads                               # like gmail
set sort_aux            = reverse-last-date-received            # like gmail
unset sort_re                                                     # always thread
set thorough_search                                             # strip headers and eval mimes before searching
set thread_received                                             # sort threads by date received, not sent
set tilde                                                       # show tildes like in vim
set timeout             = 3                                     # idle time before scanning

# enriched messages
auto_view text/html                                               # view html automatically
alternative_order text/plain text/enriched text/html              # but save it for last

# formats and regexps
set alias_format        = "%4n %t %-20a %r"
set date_format         = "%m/%d/%y at %I:%M%P"
set index_format        = "%3C %Z %[!%m/%d] %-17.17F %s"
set quote_regexp        = "^( {0,4}[>|:#%]| {0,4}[a-z0-9]+[>|]+)+"
set reply_regexp        = "^(([Rr][Ee]?(\[[0-9]+\])?: *)?(\[[^]]+\] *)?)*"
set status_format       = "-%r- %v ─┴────/ %f %m%?n? [+%n]?%?d? [-%d]?%?t? [*%t]? /%?p?───/ %p waiting to send /?─%>─(%P)───"

# index options
set sort                = threads                       # like gmail 
set sort_aux            = reverse-last-date-received    # like gmail
set sort_re                                             # thread based on reply_regexp

# pager
set pager_index_lines   = 8                             # show 8 messages when in pager
set pager_context       = 5                             # show five lines when skipping in pager
set pager_stop                                          # don't go to next message automatically
set menu_scroll                                         # scroll in menus 
set smart_wrap                                          # don't split words
set tilde                                               # show tildes like in vim
unset markers                                           # no ugly plus signs

# composing mail
set fcc_attach                                          # save attachments with the body
unset mime_forward                                      # forward attachments as part of body
set forward_format      = "Fwd: %s"                     # format for subject when forwarding
set include                                             # include message in replies
set forward_quote                                       # include message in forwards

# headers to show
ignore *                                                # ignore all headers
unignore from: to: cc: date: subject:                   # show only these
hdr_order from: to: cc: date: subject:                  # and in this order

# bindings -- very vim-like
bind pager i          exit
bind pager q          toggle-quoted
bind pager /          search
bind pager <up>       previous-line
bind pager <down>     next-line
bind pager k          previous-line
bind pager j          next-line
bind pager gg         top
bind pager G          bottom
bind index gg         first-entry
bind index G          last-entry
bind pager K          previous-undeleted
bind pager J          next-undeleted
bind index K          previous-unread
bind index J          next-unread
bind index,pager R    group-reply
